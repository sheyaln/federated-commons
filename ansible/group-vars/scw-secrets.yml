
# SCW Secrets Configuration

# Configuration for the scw-secrets role which enables runtime secret fetching
# from Scaleway Secret Manager.
#
# The scoped API key credentials should be retrieved from Scaleway Secret
# Manager during the initial bootstrap or stored in Ansible Vault.


# -----------------------------------------------------------------------------
# API Credentials (Scoped Read-Only)
# -----------------------------------------------------------------------------
# These credentials are for the scw-secrets-reader IAM application.
# They have ONLY SecretManagerReadOnly permissions.
#
# Option 1: Environment variables (recommended for CI/CD)
#   export SCW_SECRETS_ACCESS_KEY="SCWXXXXXXXXX"
#   export SCW_SECRETS_SECRET_KEY="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
#
# Option 2: Retrieve from Secret Manager during bootstrap
#   scw_secrets_access_key: "{{ lookup('scaleway.scaleway.scaleway_secret', 'scw-secrets-reader-api-credentials') | b64decode | from_json | json_query('access_key') }}"
#   scw_secrets_secret_key: "{{ lookup('scaleway.scaleway.scaleway_secret', 'scw-secrets-reader-api-credentials') | b64decode | from_json | json_query('secret_key') }}"
#
# Option 3: Ansible Vault (for local development)
#   Store in group_vars/all/vault.yml (encrypted)

# Default: Use environment variables, fall back to main Scaleway credentials
# In production, set SCW_SECRETS_ACCESS_KEY and SCW_SECRETS_SECRET_KEY to the
# scoped credentials from the scw-secrets-reader-api-credentials secret.

# Uncomment and set these if not using environment variables:
# scw_secrets_access_key: "{{ vault_scw_secrets_access_key }}"
# scw_secrets_secret_key: "{{ vault_scw_secrets_secret_key }}"

# -----------------------------------------------------------------------------
# Organization and Project
# -----------------------------------------------------------------------------
# These should match your Scaleway organization/project where secrets are stored
scw_secrets_organization_id: "{{ lookup('env', 'SCW_DEFAULT_ORGANIZATION_ID') }}"
scw_secrets_project_id: "{{ lookup('env', 'SCW_DEFAULT_PROJECT_ID') }}"

# -----------------------------------------------------------------------------
# Feature Flags
# -----------------------------------------------------------------------------
# Enable scw-secrets functionality (set to false to disable globally)
scw_secrets_enabled: true

# Allow docker group members to run fetch scripts via sudo
scw_secrets_allow_docker_group: true
