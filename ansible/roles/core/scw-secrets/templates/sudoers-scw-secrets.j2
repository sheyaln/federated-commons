
# Sudoers Configuration for SCW Secrets

# Allows the docker group to execute the fetch-secrets script as the
# scw-secrets user. This is necessary because:
#   1. The scw-secrets user owns the SCW config with sensitive credentials
#   2. Docker containers run as various users but need to fetch secrets
#   3. We want to avoid giving containers direct access to the SCW config
#
# Security Model:
#   - Only the fetch-secrets script can be executed via sudo
#   - No password required (for automation)
#   - No TTY required
#   - The scw-secrets user has no login shell
#   - The SCW API key is scoped to read-only access


# Allow docker group members to run fetch-secrets as scw-secrets user
%docker ALL=({{ scw_secrets_user }}) NOPASSWD: {{ scw_secrets_bin_dir }}/fetch-secrets

# Also allow ubuntu user (for manual testing and debugging)
ubuntu ALL=({{ scw_secrets_user }}) NOPASSWD: {{ scw_secrets_bin_dir }}/fetch-secrets
