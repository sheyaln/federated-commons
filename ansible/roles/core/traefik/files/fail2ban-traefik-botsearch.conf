# Fail2Ban filter for Traefik bot/scanner detection
# Place this file in /etc/fail2ban/filter.d/traefik-botsearch.conf

[Definition]
failregex = ^{"time":".*","id":".*","RemoteAddr":"<HOST>","ClientUsername":".*","RequestMethod":".*","RequestUri":".*/(wp-admin|wp-login|phpmyadmin|admin|administrator|xmlrpc\.php|wp-config\.php|\.env|\.git|\.htaccess|config\.php|install\.php|setup\.php|test\.php|debug\.php|shell\.php|c99\.php|r57\.php|webshell\.php|backdoor\.php|eval\.php|phpinfo\.php|info\.php|\.sql|\.bak|\.backup|\.old|\.orig|\.tmp|\.log|\.db|\.zip|\.tar|\.gz|\.rar|\.7z|cgi-bin|fckeditor|phpcms|dedecms|discuz|wordpress|drupal|joomla|magento|prestashop|opencart|oscommerce|zencart|cubecart|shopify|woocommerce|\.aspx|\.jsp|\.cgi|\.pl|\.py|\.rb|\.sh|\.bat|\.exe|\.dll|\.so|\.jar|\.war|\.ear|api/v1|api/v2|swagger|graphql|rest|soap|wsdl|wadl|json|xml|rss|atom|sitemap|robots\.txt|security\.txt|humans\.txt|crossdomain\.xml|clientaccesspolicy\.xml|favicon\.ico|apple-touch-icon|manifest\.json|browserconfig\.xml|tile\.png|mstile|msapplication).*","RequestProtocol":".*","RequestHost":".*","RequestAddr":".*","RequestPort":".*","OriginDuration":".*","OriginContentSize":".*","OriginStatus":"(404|403|400|401|500)","OriginStatusLine":".*","RequestReferer":".*","RequestUserAgent":".*","RequestCount":".*","RouterName":".*","ServiceName":".*","ServiceAddr":".*","ServiceURL":".*","ClientAddr":".*","ClientHost":".*","ClientPort":".*","ClientUsername":".*","Duration":".*","ResponseCode":".*","RetryAttempts":".*","TLSVersion":".*","TLSCipher":".*","TLSServerName":".*","DownstreamContentSize":".*","DownstreamStatus":".*","DownstreamStatusLine":".*"}$

ignoreregex = 