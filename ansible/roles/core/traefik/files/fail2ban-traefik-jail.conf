# Fail2Ban jail configuration for Traefik
# Place this file in /etc/fail2ban/jail.d/traefik.conf

[DEFAULT]
# Default ban time (10 minutes)
bantime = 10m

# Time window for counting failures (10 minutes)
findtime = 10m

# Use iptables-multiport action
banaction = iptables-multiport

# Email notifications (configure as needed)
# destemail = admin@example.com
# sender = fail2ban@example.com

[traefik-auth]
enabled = true
port = http,https
filter = traefik-auth
logpath = /opt/traefik/logs/access.log
maxretry = 3
bantime = 1h
findtime = 10m
action = iptables-multiport[name=traefik-auth, port="http,https", protocol=tcp]

[traefik-ratelimit]
enabled = true
port = http,https
filter = traefik-ratelimit
logpath = /opt/traefik/logs/access.log
maxretry = 5
bantime = 30m
findtime = 5m
action = iptables-multiport[name=traefik-ratelimit, port="http,https", protocol=tcp]

[traefik-botsearch]
enabled = true
port = http,https
filter = traefik-botsearch
logpath = /opt/traefik/logs/access.log
maxretry = 10
bantime = 24h
findtime = 1h
action = iptables-multiport[name=traefik-botsearch, port="http,https", protocol=tcp] 