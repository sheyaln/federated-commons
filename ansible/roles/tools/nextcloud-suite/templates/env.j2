# Nextcloud + OnlyOffice Suite Configuration
# Generated by Ansible

# ── Domain Configuration ─────────────────────────
NEXTCLOUD_DOMAIN={{ nextcloud_domain | default('cloud.' + tools_domain) }}
ONLYOFFICE_DOMAIN={{ onlyoffice_domain | default('docs.' + tools_domain) }}

# ── Nextcloud Database Configuration ─────────────────────────
NEXTCLOUD_DB_NAME={{ nextcloud_db_name | default('nextcloud') }}
NEXTCLOUD_DB_USER={{ nextcloud_db_user | default('nextcloud') }}
NEXTCLOUD_DB_PASSWORD={{ nextcloud_db_password | replace('$', '$$') }}

# ── OnlyOffice Database Configuration ─────────────────────────
DOCS_DB_NAME={{ docs_db_name | default('onlyoffice_docs') }}
DOCS_DB_USER={{ docs_db_user | default('onlyoffice') }}
DOCS_DB_PASSWORD={{ docs_db_password | replace('$', '$$') }}

# ── Shared Database Configuration ─────────────────────────
PG_HOST={{ shared_db_host | default('localhost') }}
PG_PORT={{ shared_db_port | default('5432') }}

# ── Redis Configuration ─────────────────────────
REDIS_PASSWORD={{ redis_password | replace('$', '$$') }}

# ── Nextcloud Admin Configuration ─────────────────────────
NEXTCLOUD_ADMIN_USER={{ nextcloud_admin_user | default('admin') }}
NEXTCLOUD_ADMIN_PASSWORD={{ nextcloud_admin_password | replace('$', '$$') }}

# ── JWT Configuration for OnlyOffice ─────────────────────────
JWT_ENABLED={{ jwt_enabled | default('true') }}
JWT_SECRET={{ jwt_secret }}
JWT_HEADER={{ jwt_header | default('Authorization') }}
JWT_IN_BODY={{ jwt_in_body | default('false') }}

# ── Security Configuration ─────────────────────────
SECURE_LINK_SECRET={{ secure_link_secret }}

# ── Performance Configuration ─────────────────────────
NGINX_WORKER_PROCESSES={{ nginx_worker_processes | default('auto') }}
NGINX_WORKER_CONNECTIONS={{ nginx_worker_connections | default('4096') }}

# ── S3 Storage Configuration ─────────────────────────
S3_ENDPOINT_HOST={{ s3_endpoint_host | default('s3.fr-par.scw.cloud') }}
S3_REGION={{ s3_region | default('fr-par') }}
S3_BUCKET={{ s3_bucket | default(project_name | default('fc') + '-nextcloud-prod-0') }}
S3_ACCESS_KEY={{ s3_access_key | replace('$', '$$') }}
S3_SECRET_KEY={{ s3_secret_key | replace('$', '$$') }}

# ── SMTP Configuration ─────────────────────────
SMTP_HOST={{ smtp_host }}
SMTP_PORT={{ smtp_port | default('587') }}
SMTP_USERNAME={{ smtp_username }}
SMTP_PASSWORD={{ smtp_password | replace('$', '$$') }}
MAIL_FROM_ADDRESS={{ mail_from_address | default('cloud@' + tools_domain) }}
MAIL_DOMAIN={{ mail_domain | default(tools_domain) }}

# ── System Configuration ─────────────────────────
TZ={{ timezone | default('America/New_York') }}

# ── Reverse Proxy Configuration ─────────────────────────
TRUSTED_PROXIES={{ trusted_proxies | default('172.0.0.0/8') }}
DEFAULT_PHONE_REGION={{ default_phone_region | default('US') }}

# ── NextCloud URL for OnlyOffice Storage Configuration ─────────────────────────
NEXTCLOUD_URL=https://{{ nextcloud_domain | default('cloud.' + tools_domain) }}

# ── Nextcloud Talk HPB Configuration ─────────────────────────
TALK_HOST={{ talk_host | default('signal.' + tools_domain) }}
TALK_PORT={{ talk_port | default('3478') }}
TURN_SECRET={{ talk_turn_secret | default('') }}
SIGNALING_SECRET={{ talk_signaling_secret | default('') }}
INTERNAL_SECRET={{ talk_internal_secret | default('') }}