RAILS_ENV=production
RAILS_LOG_TO_STDOUT=true
RAILS_SERVE_STATIC_FILES=true

# Note: $ characters are escaped as $$ for docker-compose compatibility
DATABASE_URL=postgres://{{ DECIDIM_DB_USER }}:{{ DECIDIM_DB_PASSWORD | replace('$', '$$') }}@{{ DECIDIM_DB_HOST }}:{{ DECIDIM_DB_PORT }}/{{ DECIDIM_DB_NAME }}
POSTGRES_HOST={{ DECIDIM_DB_HOST }}
POSTGRES_USER={{ DECIDIM_DB_USER }}
POSTGRES_PASSWORD={{ DECIDIM_DB_PASSWORD | replace('$', '$$') }}
POSTGRES_DB={{ DECIDIM_DB_NAME }}
POSTGRES_PORT={{ DECIDIM_DB_PORT }}

SECRET_KEY_BASE={{ DECIDIM_SECRET_KEY_BASE }}
FORCE_SSL=yes
PORT=3000

REDIS_URL=redis://decidim-redis:6379/1
MEMCACHED_HOST=decidim-memcached

SMTP_ADDRESS={{ DECIDIM_SMTP_ADDRESS }}
SMTP_DOMAIN={{ DECIDIM_SMTP_DOMAIN }}
SMTP_USERNAME={{ DECIDIM_SMTP_USERNAME }}
SMTP_PASSWORD={{ DECIDIM_SMTP_PASSWORD }}
SMTP_PORT={{ DECIDIM_SMTP_PORT }}
SMTP_AUTHENTICATION={{ DECIDIM_SMTP_AUTHENTICATION }}
SMTP_FROM_EMAIL={{ DECIDIM_SMTP_FROM_EMAIL }}

DECIDIM_HOST={{ DECIDIM_HOST }}
DECIDIM_DEFAULT_FROM_EMAIL={{ DECIDIM_SMTP_FROM_EMAIL }}

# System admin credentials (for /system panel)
DECIDIM_SYSTEM_EMAIL={{ DECIDIM_DEFAULT_ADMIN_EMAIL }}
DECIDIM_SYSTEM_PASSWORD={{ DECIDIM_DEFAULT_ADMIN_PASSWORD | replace('$', '$$') }}

# Organization configuration (auto-created on first deploy)
DECIDIM_ORG_NAME={{ org_name }}
DECIDIM_ORG_HOST={{ DECIDIM_HOST }}
DECIDIM_DEFAULT_LOCALE={{ locale.split('_')[0] }}
DECIDIM_AVAILABLE_LOCALES={{ locale.split('_')[0] }}
DECIDIM_REFERENCE_PREFIX={{ org_slug | upper }}

# Organization admin (first admin user for the org)
DECIDIM_ORG_ADMIN_EMAIL={{ admin_email }}
DECIDIM_ORG_ADMIN_PASSWORD={{ DECIDIM_DEFAULT_ADMIN_PASSWORD | replace('$', '$$') }}
DECIDIM_ORG_ADMIN_NAME={{ org_name }} Admin
DECIDIM_ORG_ADMIN_NICKNAME=admin
